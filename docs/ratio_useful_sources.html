<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>ratio_useful_sources.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>ratio useful sources</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/assets/index-_lj65MZR.js"></script>
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.14.11/dist/assets/index-CsdFJkJw.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "ratio_useful_sources.py",
            "mode": "read",
            "version": "0.14.11",
            "serverToken": "static",
            "config": {"completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "above", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "poetry"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "compact"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport json\nfrom texttable import Texttable\nfrom tabulate import tabulate\nimport sys\nfrom typing import List, Dict, Optional\nimport os\nfile_directory = \"./\"\nsys.path.append(file_directory)\nfrom generateDataset import generateDatasetFromResults, Dataset\nimport statistics ", "code_hash": "74bebdb91334f0e710a7e2d8346c3411", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "mo.md(r\"\"\"# Functions\"\"\")", "code_hash": "01315cb30528a4066664c5880105e2ba", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "def valueInTable(value_1:str, value_2:str) -> str:\n    if value_1 == \"-\":\n        return value_1\n    if value_2 == \"-\":\n        return f\"\\textbf{value_1}\"\n    if int(value_1)> int(value_2):\n        return f\"\\\\textbf{{{value_1}}}\"\n    return value_1", "code_hash": "67136cc0d73e2cc1e0518ca861aea07b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "*valueInTable"}, {"code": "def generateRatio(dataset: Dataset)-> Dict[str, List[float] | None]:\n    ratioUsefullHttpRequest = {}\n    for queryTemplate, queryResults in dataset.numberHttpRequest.items():\n        ratioUsefullHttpRequest[queryTemplate] = []\n        if sources is None:\n            return {}\n        currentSources = sources[queryTemplate]\n        for i, nHttpRequest in enumerate(queryResults):\n            if nHttpRequest is not None and currentSources[\"v{}\".format(i)] is not None:\n                oracleNHttpRequest = len(currentSources[\"v{}\".format(i)])\n                ratioUsefullHttpRequest[queryTemplate].append(oracleNHttpRequest/nHttpRequest)\n            else:\n                ratioUsefullHttpRequest[queryTemplate].append(None)\n    return ratioUsefullHttpRequest", "code_hash": "672017182c565ad605ea9b36a1d3d757", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "mo.md(r\"\"\"# Dataset\"\"\")", "code_hash": "ea8038c4d6813a4c82f3519ee269af1c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "sourceFilePath = \"./results/oracle/sources.json\"\nsources: Optional[Dict[str, Dict[str, List[str]]]] = None\nwith open(sourceFilePath, 'rb') as rf:\n    sources = json.load(rf)", "code_hash": "16b11fe499ba4888a5b976fdb1f701e0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "shapeIndexPathResult = \"./results/standard/shape_index_result.json\"\nshapeIndexPathSummary = \"./results/standard/summary_shape_index_result.json\"\nshapeIndexDataset = generateDatasetFromResults(shapeIndexPathResult, shapeIndexPathSummary, \"shapeIndex\")", "code_hash": "a56428fcb8c6c36a8af1f2df0551e5d4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "typeIndexLdpPathResult = \"./results/standard/type_index_ldp_result.json\"\ntypeIndexLdpPathSummary = \"./results/standard/summary_type_index_ldp_result.json\"\ntypeIndexLdpDataset = generateDatasetFromResults(typeIndexLdpPathResult, typeIndexLdpPathSummary, \"typeIndexLdp\")", "code_hash": "6531f8287f68acd5fcd1e8d9523abd1e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "mo.md(r\"\"\"# Calculation\"\"\")", "code_hash": "b8d4a00040babe88105171b5eb3caf92", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "query_label_mapping = {\n    \"interactive-discover-1\":\"D1\",\n    \"interactive-discover-2\": \"D2\",\n    \"interactive-discover-3\": \"D3\",\n    \"interactive-discover-4\": \"D4\",\n    \"interactive-discover-5\": \"D5\" ,\n    \"interactive-discover-6\": \"D6\",\n    \"interactive-discover-7\": \"D7\",\n    \"interactive-discover-8\": \"D8\",\n    \"interactive-short-1\": \"S1\",\n    \"interactive-short-2\": \"S2\",\n    \"interactive-short-3\": \"S3\",\n    \"interactive-short-4\": \"S4\",\n    \"interactive-short-5\": \"S5\",\n    \"interactive-short-6\": \"S6\",\n    \"interactive-short-7\": \"S7\"\n}", "code_hash": "19086fb41233dfa54e7b27ca170e5217", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "ratioUsefullHttpRequestShapeIndex = generateRatio(shapeIndexDataset)\nratioUsefullHttpRequestTypeIndex = generateRatio(typeIndexLdpDataset)", "code_hash": "b9b7711e4c95d4e77023e40beeb5bfea", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "rowsShapeIndex = []\nfor queryTemplate, ratiosShapeIndex in ratioUsefullHttpRequestShapeIndex.items():\n    currentRation = []\n    have_result = False\n    ratiosTypeIndex = ratioUsefullHttpRequestTypeIndex[queryTemplate]\n    if ratiosShapeIndex is None:\n        continue\n    for i, ratioShapeIndex in enumerate(ratiosShapeIndex):\n        if ratiosTypeIndex is not None:\n            ratioTypeIndex = ratiosTypeIndex[i]\n        else:\n            ratioTypeIndex = None\n        if ratioShapeIndex is None:\n            ratioShapeIndex = \"-\"\n        else:\n            ratioShapeIndex = \"{:.0f}\".format(ratioShapeIndex*100)\n\n        if ratioTypeIndex is None:\n            ratioTypeIndex = \"-\"\n        else:\n            ratioTypeIndex = \"{:.0f}\".format(ratioTypeIndex*100)\n\n        have_result = have_result or not (ratioShapeIndex == \"-\" and ratioTypeIndex==\"-\")\n\n        currentRation.append(\"{}/{}\".format(ratioShapeIndex, ratioTypeIndex))\n    currentRow = [query_label_mapping[queryTemplate]] + currentRation\n    if have_result:\n        rowsShapeIndex.append(currentRow)", "code_hash": "cd5f086e128b98b97e40ec366892a3d2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "mo.md(r\"\"\"# Visualisation\"\"\")", "code_hash": "0e07ddb061a4b7ae92f75f00e054dfba", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "artefactFolder = \"./artefact/ratio_useful_resources\"", "code_hash": "df99bce70e5e830da2b7d4e1a16ce816", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "head = [\"Query template\", \"v0\", \"v1\", \"v2\", \"v3\", \"v4\"]", "code_hash": "69874d98c45c7ba2129eb6d94eb66010", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "markdownTable = tabulate(rowsShapeIndex, headers=head, tablefmt=\"github\")\nprint(markdownTable)", "code_hash": "fa7c69d258c1e89a4c32ac027f7481fc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "summary = {\"SI\": [], \"T-LDP\":[]}\n\nfor row in rowsShapeIndex:\n    siVal = []\n    TldpVal = []\n    for el in row[1:]:\n        si_value, ldp_type_index_value = el.split(\"/\")\n        if si_value != \"-\":\n            siVal.append(int(si_value))\n        if ldp_type_index_value != \"-\":\n            TldpVal.append(int(ldp_type_index_value))\n    averageSiVal = int(round(statistics.mean(siVal), 0))\n    maxSiVal = int(round(max(siVal), 0))\n    minSiVal = int(round(min(siVal), 0))\n\n    averageTlpVal = int(round(statistics.mean(TldpVal), 0))\n    maxTlpVal = int(round(max(TldpVal), 0))\n    minTlpVal = int(round(min(TldpVal), 0))\n\n    stringSi = f\"{averageSiVal}^{{{maxSiVal}}}_{{{minSiVal}}}\" \n    stringTLDP = f\"{averageTlpVal}^{{{maxTlpVal}}}_{{{minTlpVal}}}\"\n\n    if averageSiVal>averageTlpVal:\n        summary[\"SI\"].append(f\"$\\\\boldsymbol{{{stringSi}}}$\")\n        summary[\"T-LDP\"].append(f\"${stringTLDP}$\")\n    elif averageSiVal<averageTlpVal:\n        summary[\"SI\"].append(f\"${stringSi}$\")\n        summary[\"T-LDP\"].append(f\"$\\\\boldsymbol{{{stringTLDP}}}$\")\n    else:\n        summary[\"SI\"].append(f\"${stringSi}$\")\n        summary[\"T-LDP\"].append(f\"${stringTLDP}$\")\n\nwith open(\"./templates/table_ratio_useful_resources_summary.tex\", \"r\") as file:\n    data = file.read()\n    for row in summary.values():\n        for value in row:\n            data = data.replace(\"{}\", f\"{value}\", 1)\n    with open(os.path.join(artefactFolder, \"table_ratio_useful_resources_summary.tex\"), \"w\") as file:\n        file.write(data)", "code_hash": "003617886c3748f15d85b611bf2eff7f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}], "metadata": {"marimo_version": "0.14.11"}, "version": "1"},
            "session": {"cells": [{"code_hash": "74bebdb91334f0e710a7e2d8346c3411", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "01315cb30528a4066664c5880105e2ba", "console": [], "id": "MJUe", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"functions\">Functions</h1></span>"}, "type": "data"}]}, {"code_hash": "67136cc0d73e2cc1e0518ca861aea07b", "console": [], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "672017182c565ad605ea9b36a1d3d757", "console": [], "id": "bkHC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ea8038c4d6813a4c82f3519ee269af1c", "console": [], "id": "lEQa", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"dataset\">Dataset</h1></span>"}, "type": "data"}]}, {"code_hash": "16b11fe499ba4888a5b976fdb1f701e0", "console": [], "id": "PKri", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "a56428fcb8c6c36a8af1f2df0551e5d4", "console": [], "id": "Xref", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "6531f8287f68acd5fcd1e8d9523abd1e", "console": [], "id": "SFPL", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b8d4a00040babe88105171b5eb3caf92", "console": [], "id": "BYtC", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"calculation\">Calculation</h1></span>"}, "type": "data"}]}, {"code_hash": "19086fb41233dfa54e7b27ca170e5217", "console": [], "id": "RGSE", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b9b7711e4c95d4e77023e40beeb5bfea", "console": [], "id": "Kclp", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "cd5f086e128b98b97e40ec366892a3d2", "console": [], "id": "emfo", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "0e07ddb061a4b7ae92f75f00e054dfba", "console": [], "id": "Hstk", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"visualisation\">Visualisation</h1></span>"}, "type": "data"}]}, {"code_hash": "df99bce70e5e830da2b7d4e1a16ce816", "console": [], "id": "nWHF", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "69874d98c45c7ba2129eb6d94eb66010", "console": [], "id": "iLit", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "fa7c69d258c1e89a4c32ac027f7481fc", "console": [{"name": "stdout", "text": "| Query template   | v0    | v1    | v2    | v3    | v4    |\n|------------------|-------|-------|-------|-------|-------|\n| D1               | 7/4   | 6/4   | 6/4   | 42/6  | 7/4   |\n| D2               | 35/34 | 11/8  | 11/9  | 91/86 | 42/40 |\n| D3               | 37/36 | 47/45 | 55/53 | 62/61 | 60/59 |\n| D4               | 13/5  | 19/13 | 19/15 | 3/3   | 20/9  |\n| D5               | 8/7   | 11/8  | 11/9  | 2/2   | 13/12 |\n| D6               | -/-   | 7/8   | 7/9   | -/-   | 41/42 |\n| D7               | -/-   | 10/12 | 11/13 | -/-   | 2/2   |\n| S1               | 12/1  | 12/7  | 12/8  | 12/1  | 12/2  |\n| S4               | 6/100 | 6/100 | 6/50  | 6/50  | 6/100 |\n| S5               | 11/4  | 11/4  | 11/2  | 11/4  | 4/3   |\n", "type": "stream"}], "id": "ZHCJ", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "003617886c3748f15d85b611bf2eff7f", "console": [], "id": "ROlb", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": null, "console": [], "id": "qnkX", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.14.11"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.14.11%22%0Aapp%20%3D%20marimo.App()%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20json%0A%20%20%20%20from%20texttable%20import%20Texttable%0A%20%20%20%20from%20tabulate%20import%20tabulate%0A%20%20%20%20import%20sys%0A%20%20%20%20from%20typing%20import%20List%2C%20Dict%2C%20Optional%0A%20%20%20%20import%20os%0A%20%20%20%20file_directory%20%3D%20%22.%2F%22%0A%20%20%20%20sys.path.append(file_directory)%0A%20%20%20%20from%20generateDataset%20import%20generateDatasetFromResults%2C%20Dataset%0A%20%20%20%20import%20statistics%20%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20Dataset%2C%0A%20%20%20%20%20%20%20%20Dict%2C%0A%20%20%20%20%20%20%20%20List%2C%0A%20%20%20%20%20%20%20%20Optional%2C%0A%20%20%20%20%20%20%20%20generateDatasetFromResults%2C%0A%20%20%20%20%20%20%20%20json%2C%0A%20%20%20%20%20%20%20%20mo%2C%0A%20%20%20%20%20%20%20%20os%2C%0A%20%20%20%20%20%20%20%20statistics%2C%0A%20%20%20%20%20%20%20%20tabulate%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Functions%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.function%0Adef%20valueInTable(value_1%3Astr%2C%20value_2%3Astr)%20-%3E%20str%3A%0A%20%20%20%20if%20value_1%20%3D%3D%20%22-%22%3A%0A%20%20%20%20%20%20%20%20return%20value_1%0A%20%20%20%20if%20value_2%20%3D%3D%20%22-%22%3A%0A%20%20%20%20%20%20%20%20return%20f%22%5Ctextbf%7Bvalue_1%7D%22%0A%20%20%20%20if%20int(value_1)%3E%20int(value_2)%3A%0A%20%20%20%20%20%20%20%20return%20f%22%5C%5Ctextbf%7B%7B%7Bvalue_1%7D%7D%7D%22%0A%20%20%20%20return%20value_1%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20Dataset%2C%0A%20%20%20%20Dict%2C%0A%20%20%20%20List%2C%0A%20%20%20%20sources%3A%20%22Optional%5BDict%5Bstr%2C%20Dict%5Bstr%2C%20List%5Bstr%5D%5D%5D%5D%22%2C%0A)%3A%0A%20%20%20%20def%20generateRatio(dataset%3A%20Dataset)-%3E%20Dict%5Bstr%2C%20List%5Bfloat%5D%20%7C%20None%5D%3A%0A%20%20%20%20%20%20%20%20ratioUsefullHttpRequest%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20for%20queryTemplate%2C%20queryResults%20in%20dataset.numberHttpRequest.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20ratioUsefullHttpRequest%5BqueryTemplate%5D%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sources%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20currentSources%20%3D%20sources%5BqueryTemplate%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20i%2C%20nHttpRequest%20in%20enumerate(queryResults)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20nHttpRequest%20is%20not%20None%20and%20currentSources%5B%22v%7B%7D%22.format(i)%5D%20is%20not%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20oracleNHttpRequest%20%3D%20len(currentSources%5B%22v%7B%7D%22.format(i)%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ratioUsefullHttpRequest%5BqueryTemplate%5D.append(oracleNHttpRequest%2FnHttpRequest)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ratioUsefullHttpRequest%5BqueryTemplate%5D.append(None)%0A%20%20%20%20%20%20%20%20return%20ratioUsefullHttpRequest%0A%20%20%20%20return%20(generateRatio%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Dataset%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Dict%2C%20List%2C%20Optional%2C%20json)%3A%0A%20%20%20%20sourceFilePath%20%3D%20%22.%2Fresults%2Foracle%2Fsources.json%22%0A%20%20%20%20sources%3A%20Optional%5BDict%5Bstr%2C%20Dict%5Bstr%2C%20List%5Bstr%5D%5D%5D%5D%20%3D%20None%0A%20%20%20%20with%20open(sourceFilePath%2C%20'rb')%20as%20rf%3A%0A%20%20%20%20%20%20%20%20sources%20%3D%20json.load(rf)%0A%20%20%20%20return%20(sources%2C)%0A%0A%0A%40app.cell%0Adef%20_(generateDatasetFromResults)%3A%0A%20%20%20%20shapeIndexPathResult%20%3D%20%22.%2Fresults%2Fstandard%2Fshape_index_result.json%22%0A%20%20%20%20shapeIndexPathSummary%20%3D%20%22.%2Fresults%2Fstandard%2Fsummary_shape_index_result.json%22%0A%20%20%20%20shapeIndexDataset%20%3D%20generateDatasetFromResults(shapeIndexPathResult%2C%20shapeIndexPathSummary%2C%20%22shapeIndex%22)%0A%20%20%20%20return%20(shapeIndexDataset%2C)%0A%0A%0A%40app.cell%0Adef%20_(generateDatasetFromResults)%3A%0A%20%20%20%20typeIndexLdpPathResult%20%3D%20%22.%2Fresults%2Fstandard%2Ftype_index_ldp_result.json%22%0A%20%20%20%20typeIndexLdpPathSummary%20%3D%20%22.%2Fresults%2Fstandard%2Fsummary_type_index_ldp_result.json%22%0A%20%20%20%20typeIndexLdpDataset%20%3D%20generateDatasetFromResults(typeIndexLdpPathResult%2C%20typeIndexLdpPathSummary%2C%20%22typeIndexLdp%22)%0A%20%20%20%20return%20(typeIndexLdpDataset%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Calculation%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20query_label_mapping%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22interactive-discover-1%22%3A%22D1%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-discover-2%22%3A%20%22D2%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-discover-3%22%3A%20%22D3%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-discover-4%22%3A%20%22D4%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-discover-5%22%3A%20%22D5%22%20%2C%0A%20%20%20%20%20%20%20%20%22interactive-discover-6%22%3A%20%22D6%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-discover-7%22%3A%20%22D7%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-discover-8%22%3A%20%22D8%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-short-1%22%3A%20%22S1%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-short-2%22%3A%20%22S2%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-short-3%22%3A%20%22S3%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-short-4%22%3A%20%22S4%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-short-5%22%3A%20%22S5%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-short-6%22%3A%20%22S6%22%2C%0A%20%20%20%20%20%20%20%20%22interactive-short-7%22%3A%20%22S7%22%0A%20%20%20%20%7D%0A%20%20%20%20return%20(query_label_mapping%2C)%0A%0A%0A%40app.cell%0Adef%20_(generateRatio%2C%20shapeIndexDataset%2C%20typeIndexLdpDataset)%3A%0A%20%20%20%20ratioUsefullHttpRequestShapeIndex%20%3D%20generateRatio(shapeIndexDataset)%0A%20%20%20%20ratioUsefullHttpRequestTypeIndex%20%3D%20generateRatio(typeIndexLdpDataset)%0A%20%20%20%20return%20ratioUsefullHttpRequestShapeIndex%2C%20ratioUsefullHttpRequestTypeIndex%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20query_label_mapping%2C%0A%20%20%20%20ratioUsefullHttpRequestShapeIndex%2C%0A%20%20%20%20ratioUsefullHttpRequestTypeIndex%2C%0A)%3A%0A%20%20%20%20rowsShapeIndex%20%3D%20%5B%5D%0A%20%20%20%20for%20queryTemplate%2C%20ratiosShapeIndex%20in%20ratioUsefullHttpRequestShapeIndex.items()%3A%0A%20%20%20%20%20%20%20%20currentRation%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20have_result%20%3D%20False%0A%20%20%20%20%20%20%20%20ratiosTypeIndex%20%3D%20ratioUsefullHttpRequestTypeIndex%5BqueryTemplate%5D%0A%20%20%20%20%20%20%20%20if%20ratiosShapeIndex%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%20%20%20%20%20%20%20%20for%20i%2C%20ratioShapeIndex%20in%20enumerate(ratiosShapeIndex)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20ratiosTypeIndex%20is%20not%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ratioTypeIndex%20%3D%20ratiosTypeIndex%5Bi%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ratioTypeIndex%20%3D%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20ratioShapeIndex%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ratioShapeIndex%20%3D%20%22-%22%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ratioShapeIndex%20%3D%20%22%7B%3A.0f%7D%22.format(ratioShapeIndex*100)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20ratioTypeIndex%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ratioTypeIndex%20%3D%20%22-%22%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ratioTypeIndex%20%3D%20%22%7B%3A.0f%7D%22.format(ratioTypeIndex*100)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20have_result%20%3D%20have_result%20or%20not%20(ratioShapeIndex%20%3D%3D%20%22-%22%20and%20ratioTypeIndex%3D%3D%22-%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20currentRation.append(%22%7B%7D%2F%7B%7D%22.format(ratioShapeIndex%2C%20ratioTypeIndex))%0A%20%20%20%20%20%20%20%20currentRow%20%3D%20%5Bquery_label_mapping%5BqueryTemplate%5D%5D%20%2B%20currentRation%0A%20%20%20%20%20%20%20%20if%20have_result%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20rowsShapeIndex.append(currentRow)%0A%20%20%20%20return%20(rowsShapeIndex%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Visualisation%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20artefactFolder%20%3D%20%22.%2Fartefact%2Fratio_useful_resources%22%0A%20%20%20%20return%20(artefactFolder%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20head%20%3D%20%5B%22Query%20template%22%2C%20%22v0%22%2C%20%22v1%22%2C%20%22v2%22%2C%20%22v3%22%2C%20%22v4%22%5D%0A%20%20%20%20return%20(head%2C)%0A%0A%0A%40app.cell%0Adef%20_(head%2C%20rowsShapeIndex%2C%20tabulate)%3A%0A%20%20%20%20markdownTable%20%3D%20tabulate(rowsShapeIndex%2C%20headers%3Dhead%2C%20tablefmt%3D%22github%22)%0A%20%20%20%20print(markdownTable)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(artefactFolder%2C%20os%2C%20rowsShapeIndex%2C%20statistics)%3A%0A%20%20%20%20summary%20%3D%20%7B%22SI%22%3A%20%5B%5D%2C%20%22T-LDP%22%3A%5B%5D%7D%0A%0A%20%20%20%20for%20row%20in%20rowsShapeIndex%3A%0A%20%20%20%20%20%20%20%20siVal%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20TldpVal%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20el%20in%20row%5B1%3A%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20si_value%2C%20ldp_type_index_value%20%3D%20el.split(%22%2F%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20si_value%20!%3D%20%22-%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20siVal.append(int(si_value))%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20ldp_type_index_value%20!%3D%20%22-%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20TldpVal.append(int(ldp_type_index_value))%0A%20%20%20%20%20%20%20%20averageSiVal%20%3D%20int(round(statistics.mean(siVal)%2C%200))%0A%20%20%20%20%20%20%20%20maxSiVal%20%3D%20int(round(max(siVal)%2C%200))%0A%20%20%20%20%20%20%20%20minSiVal%20%3D%20int(round(min(siVal)%2C%200))%0A%0A%20%20%20%20%20%20%20%20averageTlpVal%20%3D%20int(round(statistics.mean(TldpVal)%2C%200))%0A%20%20%20%20%20%20%20%20maxTlpVal%20%3D%20int(round(max(TldpVal)%2C%200))%0A%20%20%20%20%20%20%20%20minTlpVal%20%3D%20int(round(min(TldpVal)%2C%200))%0A%0A%20%20%20%20%20%20%20%20stringSi%20%3D%20f%22%7BaverageSiVal%7D%5E%7B%7B%7BmaxSiVal%7D%7D%7D_%7B%7B%7BminSiVal%7D%7D%7D%22%20%0A%20%20%20%20%20%20%20%20stringTLDP%20%3D%20f%22%7BaverageTlpVal%7D%5E%7B%7B%7BmaxTlpVal%7D%7D%7D_%7B%7B%7BminTlpVal%7D%7D%7D%22%0A%0A%20%20%20%20%20%20%20%20if%20averageSiVal%3EaverageTlpVal%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20summary%5B%22SI%22%5D.append(f%22%24%5C%5Cboldsymbol%7B%7B%7BstringSi%7D%7D%7D%24%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20summary%5B%22T-LDP%22%5D.append(f%22%24%7BstringTLDP%7D%24%22)%0A%20%20%20%20%20%20%20%20elif%20averageSiVal%3CaverageTlpVal%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20summary%5B%22SI%22%5D.append(f%22%24%7BstringSi%7D%24%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20summary%5B%22T-LDP%22%5D.append(f%22%24%5C%5Cboldsymbol%7B%7B%7BstringTLDP%7D%7D%7D%24%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20summary%5B%22SI%22%5D.append(f%22%24%7BstringSi%7D%24%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20summary%5B%22T-LDP%22%5D.append(f%22%24%7BstringTLDP%7D%24%22)%0A%0A%20%20%20%20with%20open(%22.%2Ftemplates%2Ftable_ratio_useful_resources_summary.tex%22%2C%20%22r%22)%20as%20file%3A%0A%20%20%20%20%20%20%20%20data%20%3D%20file.read()%0A%20%20%20%20%20%20%20%20for%20row%20in%20summary.values()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20value%20in%20row%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20data.replace(%22%7B%7D%22%2C%20f%22%7Bvalue%7D%22%2C%201)%0A%20%20%20%20%20%20%20%20with%20open(os.path.join(artefactFolder%2C%20%22table_ratio_useful_resources_summary.tex%22)%2C%20%22w%22)%20as%20file%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20file.write(data)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">a6639508b53ee4414e25bb4b7907a78db41bbda0e46640ef67499e8213a88fb7</marimo-code-hash>
</body>
</html>

